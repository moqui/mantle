<?xml version="1.0" encoding="UTF-8"?>
<!--
This software is in the public domain under CC0 1.0 Universal plus a Grant of Patent License.

To the extent possible under law, the author(s) have dedicated all
copyright and related and neighboring rights to this software to the
public domain worldwide. This software is distributed without any
warranty.

You should have received a copy of the CC0 Public Domain Dedication
along with this software (see the LICENSE.md file). If not, see
<http://creativecommons.org/publicdomain/zero/1.0/>.
-->
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-1.5.xsd">
    <!-- ========================================================= -->
    <!--  - mantle.account.billing -->
    <!--  - mantle.account.financial -->
    <!--  - mantle.account.invoice -->
    <!--  - mantle.account.method -->
    <!--  - mantle.account.payment -->
    <!-- ========================================================= -->

    <!-- ========================================================= -->
    <!-- mantle.account.billing -->
    <!-- ========================================================= -->

    <entity entity-name="BillingAccount" package-name="mantle.account.billing">
        <field name="billingAccountId" type="id" is-pk="true"/>
        <field name="billToPartyId" type="id"/>
        <field name="billFromPartyId" type="id"/>
        <field name="accountLimit" type="currency-amount"/>
        <field name="accountLimitUomId" type="id"/>
        <field name="postalContactMechId" type="id"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="description" type="text-medium"/>
        <field name="externalAccountId" type="id"/>
        <relationship type="one" title="BillTo" related-entity-name="mantle.party.Party">
            <key-map field-name="billToPartyId"/></relationship>
        <relationship type="one" title="AccountLimit" related-entity-name="moqui.basic.Uom">
            <key-map field-name="accountLimitUomId"/></relationship>
        <relationship type="one" title="Postal" related-entity-name="mantle.party.contact.ContactMech">
            <key-map field-name="postalContactMechId"/></relationship>
        <relationship type="one" related-entity-name="mantle.party.contact.PostalAddress">
            <key-map field-name="postalContactMechId"/></relationship>
    </entity>
    <entity entity-name="BillingAccountParty" package-name="mantle.account.billing">
        <field name="billingAccountId" type="id" is-pk="true"/>
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="fromDate" type="date-time" is-pk="true"/>
        <field name="thruDate" type="date-time"/>
        <relationship type="one" related-entity-name="mantle.account.billing.BillingAccount"/>
        <relationship type="one" related-entity-name="mantle.party.Party"/>
        <relationship type="one" related-entity-name="mantle.party.RoleType"/>
    </entity>
    <entity entity-name="BillingAccountTerm" package-name="mantle.account.billing">
        <field name="billingAccountTermId" type="id" is-pk="true"/>
        <field name="billingAccountId" type="id"/>
        <field name="termTypeEnumId" type="id"/>
        <field name="termValue" type="number-decimal"/>
        <field name="termUomId" type="id"/>
        <relationship type="one" title="BillingAccountTermType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="termTypeEnumId"/></relationship>
        <relationship type="one" title="Term" related-entity-name="moqui.basic.Uom">
            <key-map field-name="termUomId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.billing.BillingAccount"/>
        <seed-data>
            <!-- Billing Account Term Type -->
            <moqui.basic.EnumerationType description="Billing Account Term Type" enumTypeId="BillingAccountTermType"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.financial -->
    <!-- ========================================================= -->

    <entity entity-name="FinancialAccount" package-name="mantle.account.financial">
        <field name="finAccountId" type="id" is-pk="true"/>
        <field name="finAccountTypeId" type="id"/>
        <field name="statusId" type="id" enable-audit-log="true"/>
        <field name="finAccountName" type="text-medium"/>
        <field name="finAccountCode" type="text-medium" encrypt="true"/>
        <field name="finAccountPin" type="text-medium" encrypt="true"/>
        <field name="organizationPartyId" type="id"><description>The internal organization Party that is liable for the
            account.</description></field>
        <field name="ownerPartyId" type="id"/>
        <field name="postToGlAccountId" type="id"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="isRefundable" type="text-indicator"/>
        <field name="currencyUomId" type="id"/>
        <field name="actualBalance" type="currency-amount"><description>Calculated as the sum of
            FinancialAccountTrans.amount</description></field>
        <field name="availableBalance" type="currency-amount"><description>Calculated as actualBalance minus sum of
            outstanding FinancialAccountAuth.amount</description></field>
        <field name="replenishPaymentId" type="id"/>
        <field name="replenishLevel" type="currency-amount"/>
        <relationship type="one" related-entity-name="FinancialAccountType">
            <key-map field-name="finAccountTypeId"/></relationship>
        <relationship type="one" title="FinancialAccount" related-entity-name="moqui.basic.StatusItem"/>
        <relationship type="one" title="Organization" related-entity-name="mantle.party.Party">
            <key-map field-name="organizationPartyId"/></relationship>
        <relationship type="one" title="Owner" related-entity-name="mantle.party.Party">
            <key-map field-name="ownerPartyId"/></relationship>
        <relationship type="one" title="PostTo" related-entity-name="mantle.ledger.account.GlAccount">
            <key-map field-name="postToGlAccountId"/></relationship>
        <relationship type="one" title="Currency" related-entity-name="moqui.basic.Uom">
            <key-map field-name="currencyUomId"/></relationship>
        <relationship type="one" title="Replenish" related-entity-name="mantle.account.method.PaymentMethod">
            <key-map field-name="replenishPaymentId"/></relationship>
        <seed-data>
            <!-- Financial Account Status -->
            <moqui.basic.StatusType description="Financial Account Status" statusTypeId="FinancialAccount"/>
            <moqui.basic.StatusItem description="Active" sequenceNum="1" statusId="FaActive" statusTypeId="FinancialAccount"/>
            <!-- This is set automatically by the auto-replenishment code to allow one transaction to bring the balance below
                zero and then if any other transactions are attempted during replenishment they will be rejected. -->
            <moqui.basic.StatusItem description="Negative Pending Replenishment" sequenceNum="2" statusId="FaNegPendRepl" statusTypeId="FinancialAccount"/>
            <!-- This is meant to be set manually by a company representative to freeze an account so further transactions are
                not allowed. -->
            <moqui.basic.StatusItem description="Manually Frozen" sequenceNum="3" statusId="FaManFrozen" statusTypeId="FinancialAccount"/>
            <moqui.basic.StatusItem description="Cancelled" sequenceNum="9" statusId="FaCancelled" statusTypeId="FinancialAccount"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaActive" toStatusId="FaNegPendRepl" transitionName="Set Negative Pending Replenishment"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaActive" toStatusId="FaManFrozen" transitionName="Set Manually Frozen"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaActive" toStatusId="FaCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaNegPendRepl" toStatusId="FaActive" transitionName="Re-activate"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaNegPendRepl" toStatusId="FaManFrozen" transitionName="Manually Freeze"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaNegPendRepl" toStatusId="FaCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaManFrozen" toStatusId="FaActive" transitionName="Re-activate"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FaManFrozen" toStatusId="FaCancelled" transitionName="Cancel"/>
        </seed-data>
    </entity>
    <entity entity-name="FinancialAccountAuth" package-name="mantle.account.financial">
        <field name="finAccountAuthId" type="id" is-pk="true"/>
        <field name="finAccountId" type="id"/>
        <field name="amount" type="currency-amount"/>
        <field name="authorizationDate" type="date-time"/>
        <field name="expireDate" type="date-time"/>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccount"/>
    </entity>
    <entity entity-name="FinancialAccountParty" package-name="mantle.account.financial">
        <field name="finAccountId" type="id" is-pk="true"/>
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="fromDate" type="date-time" is-pk="true"/>
        <field name="thruDate" type="date-time"/>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccount"/>
        <relationship type="one" related-entity-name="mantle.party.Party"/>
        <relationship type="one" related-entity-name="mantle.party.RoleType"/>
    </entity>
    <entity entity-name="FinancialAccountTrans" package-name="mantle.account.financial" create-only="true">
        <field name="finAccountTransId" type="id" is-pk="true"/>
        <field name="finAccountTransTypeEnumId" type="id"/>
        <field name="finAccountId" type="id"/>
        <field name="finAccountAuthId" type="id"><description>Only set for withdrawals based on an auth.</description></field>
        <!-- don't want status, using create-only approach: <field name="statusId" type="id"/> -->
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>
        <field name="glReconciliationId" type="id" create-only="false"/>
        <field name="reasonEnumId" type="id"><description>Used to determine the balancing GlAccount to the one based
            on FinancialAccount.finAccountTypeId.</description></field>
        <field name="transactionDate" type="date-time"/>
        <field name="entryDate" type="date-time"/>
        <field name="amount" type="currency-amount"/>
        <field name="postBalance" type="currency-amount"/>
        <field name="paymentId" type="id"/>
        <field name="orderId" type="id"/>
        <field name="orderItemSeqId" type="id"><description>To be used along with orderId to point to an OrderItem that
            represents the purchase of a product to add money to the account.</description></field>
        <field name="performedByUserId" type="id-long"/>
        <field name="acctgTransResultEnumId" type="id" create-only="false"/>
        <field name="comments" type="text-medium"/>
        <relationship type="one" title="FinancialAccountTransType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="finAccountTransTypeEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccount"/>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccountAuth"/>
        <!-- <relationship type="one" title="FinancialAccountTrans" related-entity-name="moqui.basic.StatusItem"/> -->
        <relationship type="one" title="From" related-entity-name="mantle.party.Party">
            <key-map field-name="fromPartyId"/></relationship>
        <relationship type="one" title="To" related-entity-name="mantle.party.Party">
            <key-map field-name="toPartyId"/></relationship>
        <relationship type="one" related-entity-name="mantle.ledger.reconciliation.GlReconciliation"/>
        <relationship type="one" title="FinancialAccountTransReason" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="reasonEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" related-entity-name="mantle.order.OrderItem">
            <key-map field-name="orderId"/><key-map field-name="orderItemSeqId"/></relationship>
        <relationship type="one" title="PerformedBy" related-entity-name="moqui.security.UserAccount">
            <key-map field-name="performedByUserId"/></relationship>
        <relationship type="one" title="AcctgTransResult" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="acctgTransResultEnumId"/></relationship>
        <seed-data>
            <!-- Financial Account Trans Type -->
            <moqui.basic.EnumerationType description="Financial Account Trans Type" enumTypeId="FinancialAccountTransType"/>
            <moqui.basic.Enumeration description="Deposit" enumId="FattDeposit" enumTypeId="FinancialAccountTransType"/>
            <moqui.basic.Enumeration description="Withdraw" enumId="FattWithdraw" enumTypeId="FinancialAccountTransType"/>
            <moqui.basic.Enumeration description="Adjustment" enumId="FattAdjustment" enumTypeId="FinancialAccountTransType"/>

            <!-- Financial Account Trans Status -->
            <!-- don't want status, using create-only approach:
            <moqui.basic.StatusType statusTypeId="FinancialAccountTrans" description="Financial Account Trans Status"/>
            <moqui.basic.StatusItem statusId="FatCreated" statusTypeId="FinancialAccountTrans" sequenceNum="1" description="Created"/>
            <moqui.basic.StatusItem statusId="FatApproved" statusTypeId="FinancialAccountTrans" sequenceNum="2" description="Approved"/>
            <moqui.basic.StatusItem statusId="FatCancelled" statusTypeId="FinancialAccountTrans" sequenceNum="9" description="Cancelled"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FatCreated" toStatusId="FatApproved" transitionName="Approve"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FatCreated" toStatusId="FatCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="FatApproved" toStatusId="FatCancelled" transitionName="Cancel"/>
            -->

            <!-- Financial Account Trans Reason -->
            <moqui.basic.EnumerationType description="Financial Account Trans Reason" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Purchase" enumId="FatrPurchase" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Initial Deposit" enumId="FatrInitDeposit" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Replenishment" enumId="FatrReplenish" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Refund" enumId="FatrRefund" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Disbursement" enumId="FatrDisbursement" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Customer Service Credit" enumId="FatrCsCredit" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Error Adjustment" enumId="FatrErrorAdjust" enumTypeId="FinancialAccountTransReason"/>
        </seed-data>
    </entity>
    <entity entity-name="FinancialAccountType" package-name="mantle.account.financial">
        <field name="finAccountTypeId" type="id" is-pk="true"/>
        <field name="parentTypeId" type="id"/>
        <field name="description" type="text-medium"/>

        <field name="isRefundable" type="text-indicator"/>
        <field name="accountCodeLength" type="number-integer"/>
        <field name="requirePinCode" type="text-indicator"/>
        <field name="pinCodeLength" type="number-integer"/>
        <field name="accountValidDays" type="number-integer"/>
        <field name="authValidDays" type="number-integer"/>
        <field name="allowAuthToNegative" type="text-indicator"/>

        <field name="replenishMinBalance" type="currency-amount"/>
        <field name="replenishThreshold" type="currency-amount"/>
        <field name="replenishMethodEnumId" type="id"/>
        <field name="replenishTypeEnumId" type="id"/>

        <relationship type="one" title="Parent" related-entity-name="mantle.account.financial.FinancialAccountType">
            <key-map field-name="parentTypeId" related-field-name="finAccountTypeId"/></relationship>
        <relationship type="one" title="FinancialAccountReplenishMethod" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="replenishMethodEnumId"/></relationship>
        <relationship type="one" title="FinancialAccountReplenishType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="replenishTypeEnumId"/></relationship>
        <seed-data>
            <!-- Financial Account Replenish Type -->
            <moqui.basic.EnumerationType description="Financial Account Replenish Type" enumTypeId="FinancialAccountReplenishType"/>
            <moqui.basic.Enumeration description="Automatic Replenish" enumId="FarpAutomatic" enumTypeId="FinancialAccountReplenishType"/>
            <moqui.basic.Enumeration description="Manual Replenish" enumId="FarpManual" enumTypeId="FinancialAccountReplenishType"/>
            <moqui.basic.Enumeration description="No Replenish" enumId="FarpNone" enumTypeId="FinancialAccountReplenishType"/>

            <!-- Financial Account Replenish Method -->
            <moqui.basic.EnumerationType description="Financial Account Replenish Method" enumTypeId="FinancialAccountReplenishMethod"/>
            <moqui.basic.Enumeration description="Top-off" enumId="FarmTopOff" enumTypeId="FinancialAccountReplenishMethod"/>
            <moqui.basic.Enumeration description="Replenish-level" enumId="FarmLevel" enumTypeId="FinancialAccountReplenishMethod"/>

            <!-- Financial Account Type (NOTE: not an Enumeration because has additional fields) -->
            <mantle.account.financial.FinancialAccountType description="Gift Certificate" finAccountTypeId="GiftCertificate"
                                  replenishTypeEnumId="FarpManual" isRefundable="N"/>
            <mantle.account.financial.FinancialAccountType description="Deposit Account" finAccountTypeId="DepositAccount"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y"/>
            <mantle.account.financial.FinancialAccountType description="Bank Account" finAccountTypeId="BankAccount"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y" parentTypeId="DepositAccount"/>
            <mantle.account.financial.FinancialAccountType description="Store Credit Account" finAccountTypeId="StoreCredit"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y" parentTypeId="DepositAccount"/>
            <mantle.account.financial.FinancialAccountType description="Investment Account" finAccountTypeId="Investment"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y" parentTypeId="DepositAccount"/>
            <mantle.account.financial.FinancialAccountType description="Replenish Account" finAccountTypeId="Replenish"
                                  replenishTypeEnumId="FarpAutomatic" isRefundable="Y" parentTypeId="DepositAccount"/>
            <mantle.account.financial.FinancialAccountType description="Service Credit Account" finAccountTypeId="ServiceCredit"
                                  replenishTypeEnumId="FarpManual" isRefundable="N"/>
            <mantle.account.financial.FinancialAccountType description="Loan Account" finAccountTypeId="LoanAccount"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y"/>
            <mantle.account.financial.FinancialAccountType description="Credit Card Account" finAccountTypeId="CreditCard"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y" parentTypeId="LoanAccount"/>
            <mantle.account.financial.FinancialAccountType description="Equity Line Account" finAccountTypeId="EquityLine"
                                  replenishTypeEnumId="FarpManual" isRefundable="Y" parentTypeId="LoanAccount"/>
            <mantle.account.financial.FinancialAccountType description="Supplier Deposit Account" finAccountTypeId="SupplierDepositAccount"
                    replenishTypeEnumId="FarpManual" isRefundable="Y"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.invoice -->
    <!-- ========================================================= -->

    <entity entity-name="Invoice" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="invoiceTypeEnumId" type="id"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>
        <field name="statusId" type="id" enable-audit-log="true"/>
        <field name="billingAccountId" type="id"/>
        <field name="invoiceDate" type="date-time"/>
        <field name="dueDate" type="date-time"/>
        <field name="settlementTermId" type="id"/>
        <field name="paidDate" type="date-time"/>
        <field name="invoiceMessage" type="text-long"/>
        <field name="referenceNumber" type="text-medium"><description>Vendor or other invoice number.</description></field>
        <field name="description" type="text-medium"/>
        <field name="currencyUomId" type="id"/>
        <field name="overrideOrgPartyId" type="id"><description>Used to specify the organization override rather than
            using the fromPartyId and/or toPartyId (depending on which is an internal org).</description></field>

        <field name="partyRelationshipId" type="id"><description>For Payroll invoices, points to Employment record</description></field>
        <field name="timePeriodId" type="id"><description>For Payroll invoices, points to Payroll TimePeriod</description></field>
        <field name="acctgTransResultEnumId" type="id"/>
        <field name="systemMessageRemoteId" type="id"/>

        <relationship type="one" title="InvoiceType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="invoiceTypeEnumId"/></relationship>
        <relationship type="one" title="From" related-entity-name="mantle.party.Party">
            <key-map field-name="fromPartyId"/></relationship>
        <relationship type="one" title="To" related-entity-name="mantle.party.Party">
            <key-map field-name="toPartyId"/></relationship>
        <relationship type="one" title="Invoice" related-entity-name="moqui.basic.StatusItem"/>
        <relationship type="one" related-entity-name="mantle.account.billing.BillingAccount"/>
        <relationship type="one" related-entity-name="mantle.account.invoice.SettlementTerm"/>
        <relationship type="one" title="Currency" related-entity-name="moqui.basic.Uom">
            <key-map field-name="currencyUomId"/></relationship>
        <relationship type="one" title="OverrideOrg" related-entity-name="mantle.party.Party">
            <key-map field-name="overrideOrgPartyId"/></relationship>

        <relationship type="one" related-entity-name="mantle.humanres.employment.Employment"/>
        <relationship type="one" related-entity-name="mantle.party.time.TimePeriod"/>
        <relationship type="one" title="AcctgTransResult" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="acctgTransResultEnumId"/></relationship>
        <relationship type="one" related-entity-name="moqui.service.message.SystemMessageRemote"/>

        <seed-data>
            <!-- Invoice Type -->
            <moqui.basic.EnumerationType description="Invoice Type" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Sales/Purchase" enumId="InvoiceSales" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Return" enumId="InvoiceReturn" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Payroll" enumId="InvoicePayroll" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Tax" enumId="InvoiceTax" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Garnishment" enumId="InvoiceGarnishment" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Commission" enumId="InvoiceCommission" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Template" enumId="InvoiceTemplate" enumTypeId="InvoiceType"/>

            <!-- Invoice Status -->
            <moqui.basic.StatusType description="Invoice Status" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="In-Process" sequenceNum="1" statusId="InvoiceInProcess" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Finalized" sequenceNum="2" statusId="InvoiceFinalized" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Sent" sequenceNum="3" statusId="InvoiceSent" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Payment Received" sequenceNum="4" statusId="InvoicePmtRecvd" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Write Off" sequenceNum="9" statusId="InvoiceWriteOff" statusTypeId="Invoice"/>

            <moqui.basic.StatusItem description="Incoming" sequenceNum="10" statusId="InvoiceIncoming" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Received" sequenceNum="11" statusId="InvoiceReceived" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Approved" sequenceNum="12" statusId="InvoiceApproved" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Payment Sent" sequenceNum="13" statusId="InvoicePmtSent" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Billed Through" sequenceNum="15" statusId="InvoiceBilledThrough" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Cancelled" sequenceNum="99" statusId="InvoiceCancelled" statusTypeId="Invoice"/>

            <!-- The basic process is: In Process, Finalized/Approved, Sent (optional), Payment Received or Write Off -->
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceInProcess" toStatusId="InvoiceFinalized" transitionName="Finalize"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceFinalized" toStatusId="InvoiceSent" transitionName="Send"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceFinalized" toStatusId="InvoicePmtRecvd" transitionName="Receive Payment"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceSent" toStatusId="InvoicePmtRecvd" transitionName="Receive Payment"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceFinalized" toStatusId="InvoiceWriteOff" transitionName="Write Off"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceSent" toStatusId="InvoiceWriteOff" transitionName="Write Off"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceWriteOff" toStatusId="InvoicePmtRecvd" transitionName="Receive Payment"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceInProcess" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceFinalized" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceSent" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoicePmtRecvd" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceWriteOff" toStatusId="InvoiceCancelled" transitionName="Cancel"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoicePmtRecvd" toStatusId="InvoiceFinalized" transitionName="Unpay"/>

            <!-- if changes are needed after Finalized or Sent then go back to In Process -->
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceSent" toStatusId="InvoiceInProcess" transitionName="Resume Changes"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceFinalized" toStatusId="InvoiceInProcess" transitionName="Resume Changes"/>

            <!-- Incoming invoices should start in Received and then move to Approved, then Payment Sent -->
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceIncoming" toStatusId="InvoiceReceived" transitionName="Receive"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceReceived" toStatusId="InvoiceApproved" transitionName="Approve"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceApproved" toStatusId="InvoiceReceived" transitionName="Resume Changes"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceApproved" toStatusId="InvoicePmtSent" transitionName="Send Payment"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoicePmtSent" toStatusId="InvoiceBilledThrough" transitionName="Bill Through"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoicePmtSent" toStatusId="InvoiceApproved" transitionName="Unpay"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceIncoming" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceReceived" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoiceApproved" toStatusId="InvoiceCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="InvoicePmtSent" toStatusId="InvoiceCancelled" transitionName="Cancel"/>

            <!--
            - X GL Posting on any transition to Finalized or Approved statuses.
            - X Reverse GL Posting on Finalized/Approved/Sent/Payment* to Cancelled
            - X Reverse GL Posting on Finalized/Sent to In Process
            - TODO: GL Postings on transition to Write Off, and on Write Off to Payment
            - X On Payment* to Finalized/Approved/Cancelled, unapply Payment(s)
            -->

        </seed-data>
    </entity>
    <extend-entity entity-name="SystemMessage" package-name="moqui.service.message">
        <field name="invoiceId" type="id"/>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice"/>
    </extend-entity>

    <entity entity-name="InvoiceContactMech" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="contactMechPurposeId" type="id" is-pk="true"/>
        <field name="contactMechId" type="id" is-pk="true"/>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice"/>
        <relationship type="one" related-entity-name="mantle.party.contact.ContactMechPurpose"/>
        <relationship type="one" related-entity-name="mantle.party.contact.ContactMech"/>
        <relationship type="one-nofk" related-entity-name="mantle.party.contact.PostalAddress"/>
        <relationship type="one-nofk" related-entity-name="mantle.party.contact.TelecomNumber"/>
    </entity>
    <entity entity-name="InvoiceContent" package-name="mantle.account.invoice">
        <field name="invoiceContentId" type="id" is-pk="true"/>
        <field name="invoiceId" type="id"/>
        <field name="contentLocation" type="text-medium"/>
        <field name="contentTypeEnumId" type="id"/>
        <field name="description" type="text-long"/>
        <field name="contentDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="userId" type="id-long" default="ec.user.userId"/>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice"/>
        <relationship type="one" title="InvoiceContentType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="contentTypeEnumId"/></relationship>
        <seed-data>
            <!-- Invoice Content Type -->
            <moqui.basic.EnumerationType description="Invoice Content Type" enumTypeId="InvoiceContentType"/>
            <moqui.basic.Enumeration enumId="IctInvoiceDocument" description="Invoice Document" enumTypeId="InvoiceContentType"/>
            <moqui.basic.Enumeration enumId="IctReceipt" description="Receipt" enumTypeId="InvoiceContentType"/>
            <moqui.basic.Enumeration enumId="IctItemImage" description="Item Image" enumTypeId="InvoiceContentType"/>
            <moqui.basic.Enumeration enumId="IctNote" description="Note" enumTypeId="InvoiceContentType"/>
        </seed-data>
    </entity>
    <entity entity-name="InvoiceItem" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="invoiceItemSeqId" type="id" is-pk="true"/>
        <field name="itemTypeEnumId" type="id"/>
        <field name="overrideGlAccountId" type="id"><description>The override or actual glAccountId used for the
            AcctgTransEntry based on the InvoiceItem. If empty the glAccountId will be determined based on configuration
            or custom code.</description></field>
        <field name="assetId" type="id"><description>For sale of a particular asset, required for fixed assets</description></field>
        <field name="productId" type="id"/>
        <field name="parentInvoiceId" type="id"/>
        <field name="parentInvoiceItemSeqId" type="id"/>
        <field name="taxableFlag" type="text-indicator"/>
        <field name="quantity" type="number-decimal"/>
        <field name="quantityUomId" type="id"/>
        <field name="amount" type="currency-precise"/>
        <field name="description" type="text-medium"/>
        <field name="itemDate" type="date-time"/>
        <field name="salesOpportunityId" type="id"/>
        <field name="taxAuthorityId" type="id"/>
        <field name="payrollAdjustmentId" type="id"/>

        <relationship type="one" title="ItemType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="itemTypeEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice"/>
        <relationship type="one" related-entity-name="mantle.product.asset.Asset"/>
        <relationship type="one" related-entity-name="mantle.product.Product"/>
        <relationship type="one" title="Parent" related-entity-name="mantle.account.invoice.InvoiceItem">
            <key-map field-name="parentInvoiceId" related-field-name="invoiceId"/>
            <key-map field-name="parentInvoiceItemSeqId" related-field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" title="Override" related-entity-name="mantle.ledger.account.GlAccount">
            <key-map field-name="overrideGlAccountId"/></relationship>
        <relationship type="one" title="Quantity" related-entity-name="moqui.basic.Uom">
            <key-map field-name="quantityUomId"/></relationship>
        <relationship type="one" related-entity-name="SalesOpportunity"/>
        <relationship type="one" related-entity-name="mantle.other.tax.TaxAuthority"/>
        <relationship type="one" related-entity-name="mantle.humanres.employment.PayrollAdjustment"/>
    </entity>
    <entity entity-name="InvoiceItemAssoc" package-name="mantle.account.invoice">
        <field name="invoiceItemAssocId" type="id" is-pk="true"/>
        <field name="invoiceId" type="id"/>
        <field name="invoiceItemSeqId" type="id"/>
        <field name="toInvoiceId" type="id"/>
        <field name="toInvoiceItemSeqId" type="id"/>
        <field name="invoiceItemAssocTypeEnumId" type="id"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>
        <field name="quantity" type="number-decimal"/>
        <field name="amount" type="currency-amount"/>
        <relationship type="one" title="InvoiceItemAssocType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="invoiceItemAssocTypeEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.invoice.InvoiceItem">
            <key-map field-name="invoiceId"/><key-map field-name="invoiceItemSeqId"/></relationship>
        <relationship type="one" title="To" related-entity-name="mantle.account.invoice.InvoiceItem">
            <key-map field-name="toInvoiceId" related-field-name="invoiceId"/>
            <key-map field-name="toInvoiceItemSeqId" related-field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" title="From" related-entity-name="mantle.party.Party">
            <key-map field-name="fromPartyId"/></relationship>
        <relationship type="one" title="To" related-entity-name="mantle.party.Party">
            <key-map field-name="toPartyId"/></relationship>
        <seed-data>
            <!-- Invoice Item Assoc Type -->
            <moqui.basic.EnumerationType description="Invoice Item Assoc Type" enumTypeId="InvoiceItemAssocType"/>
            <moqui.basic.Enumeration description="Commission" enumId="IiatCommission" enumTypeId="InvoiceItemAssocType"/>
            <moqui.basic.Enumeration description="Withdraw" enumId="IiatWithdraw" enumTypeId="InvoiceItemAssocType"/>
            <moqui.basic.Enumeration description="Bill Through" enumId="IiatBillThrough" enumTypeId="InvoiceItemAssocType"/>
            <moqui.basic.Enumeration description="Related" enumId="IiatRelated" enumTypeId="InvoiceItemAssocType"/>
        </seed-data>
    </entity>
    <entity entity-name="InvoiceParty" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="datetimePerformed" type="date-time"/>
        <field name="percentage" type="number-decimal"/>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice"/>
        <relationship type="one" related-entity-name="mantle.party.Party"/>
        <relationship type="one" related-entity-name="mantle.party.RoleType"/>
    </entity>
    <entity entity-name="InvoiceTerm" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="invoiceItemSeqId" type="id" is-pk="true"/>
        <field name="settlementTermId" type="id" is-pk="true"/>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice">
            <key-map field-name="invoiceId"/></relationship>
        <relationship type="one-nofk" related-entity-name="mantle.account.invoice.InvoiceItem">
            <key-map field-name="invoiceId"/><key-map field-name="invoiceItemSeqId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.invoice.SettlementTerm"/>
    </entity>
    <entity entity-name="SettlementTerm" package-name="mantle.account.invoice">
        <field name="settlementTermId" type="id" is-pk="true"/>
        <field name="termTypeEnumId" type="id"/>
        <field name="description" type="text-medium"/>
        <field name="termValue" type="number-decimal"/>
        <field name="termValueUomId" type="id"/>
        <relationship type="one" title="TermType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="termTypeEnumId"/></relationship>
        <relationship type="one" title="TermValue" related-entity-name="moqui.basic.Uom">
            <key-map field-name="termValueUomId"/></relationship>
        <seed-data>
            <!-- NOTE: this is not an Enumeration because it needs additional fields -->
            <SettlementTerm settlementTermId="Immediate" description="Immediate (Due on Delivery)" termValue="0" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="Net15" description="Net Due in 15 Days" termValue="15" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="Net30" description="Net Due in 30 Days" termValue="30" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="Net60" description="Net Due in 60 Days" termValue="60" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="Net90" description="Net Due in 90 Days" termValue="90" termValueUomId="TF_day"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.method -->
    <!-- ========================================================= -->

    <entity entity-name="PaymentMethod" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="paymentMethodTypeEnumId" type="id"/>
        <field name="ownerPartyId" type="id"/>
        <field name="description" type="text-medium"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="openedDate" type="date-time"/>

        <field name="titleOnAccount" type="text-medium"><description>Not commonly used; payment gateways generally only
            separate first and last names</description></field>
        <field name="firstNameOnAccount" type="text-medium"/>
        <field name="middleNameOnAccount" type="text-medium"><description>Not commonly used; payment gateways generally only
                    separate first and last names; for credit cards middle initial generally included with first name</description></field>
        <field name="lastNameOnAccount" type="text-medium"/>
        <field name="suffixOnAccount" type="text-medium"><description>Not commonly used; payment gateways generally only
                    separate first and last names</description></field>
        <field name="companyNameOnAccount" type="text-medium"/>

        <field name="ledgerBalance" type="currency-amount"/>
        <field name="availableBalance" type="currency-amount"/>
        <field name="balanceDate" type="date-time"/>

        <field name="currencyUomId" type="id"/>
        <field name="postalContactMechId" type="id"/>
        <field name="telecomContactMechId" type="id"/>
        <field name="emailContactMechId" type="id"/>
        <field name="trustLevelEnumId" type="id"/>
        <field name="paymentFraudEvidenceId" type="id"><description>Refer to evidence here if trust level is gray listed or black listed</description></field>
        <field name="glAccountId" type="id"><description>A GL Account associated with this PaymentMethod for reconciliation, etc</description></field>
        <field name="finAccountId" type="id"/>
        <field name="originalPaymentMethodId" type="id"><description>Because PaymentMethod records are treated as
            immutable (except for certain fields) they are cloned and expired on update and this field will have the
            paymentMethodId of the original record.</description></field>

        <relationship type="one" title="PaymentMethodType" related-entity-name="moqui.basic.Enumeration" short-alias="methodType">
            <key-map field-name="paymentMethodTypeEnumId"/></relationship>
        <relationship type="one" title="Owner" related-entity-name="mantle.party.Party" short-alias="ownerParty">
            <key-map field-name="ownerPartyId"/></relationship>
        <relationship type="one" title="Currency" related-entity-name="moqui.basic.Uom">
            <key-map field-name="currencyUomId"/></relationship>
        <relationship type="one" title="Postal" related-entity-name="mantle.party.contact.ContactMech" short-alias="postal">
            <key-map field-name="postalContactMechId"/></relationship>
        <relationship type="one" related-entity-name="mantle.party.contact.PostalAddress">
            <key-map field-name="postalContactMechId"/></relationship>
        <relationship type="one" title="Telecom" related-entity-name="mantle.party.contact.ContactMech" short-alias="telecom">
            <key-map field-name="telecomContactMechId"/></relationship>
        <relationship type="one" related-entity-name="mantle.party.contact.TelecomNumber">
            <key-map field-name="telecomContactMechId"/></relationship>
        <relationship type="one" title="Email" related-entity-name="mantle.party.contact.ContactMech" short-alias="email">
            <key-map field-name="emailContactMechId"/></relationship>
        <relationship type="one" title="ContactPaymentTrustLevel" related-entity-name="moqui.basic.Enumeration" short-alias="trustLevel">
            <key-map field-name="trustLevelEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.PaymentFraudEvidence"/>
        <relationship type="one" related-entity-name="mantle.ledger.account.GlAccount"/>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccount"/>

        <relationship type="one-nofk" related-entity-name="mantle.account.method.BankAccount" short-alias="bankAccount"/>
        <relationship type="one-nofk" related-entity-name="mantle.account.method.BitcoinWallet" short-alias="bitcoinWallet"/>
        <relationship type="one-nofk" related-entity-name="mantle.account.method.CreditCard" short-alias="creditCard"/>
        <relationship type="one-nofk" related-entity-name="mantle.account.method.GiftCard" short-alias="giftCard"/>
        <relationship type="one-nofk" related-entity-name="mantle.account.method.PayPalAccount" short-alias="payPalAccount"/>

        <seed-data>
            <!-- Payment Method Type -->
            <moqui.basic.EnumerationType description="Payment Method Type" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Bank Account (ACH, etc)" enumId="PmtBankAccount" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Bitcoin Wallet" enumId="PmtBitcoinWallet" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Credit Card" enumId="PmtCreditCard" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Gift Card" enumId="PmtGiftCard" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Gift Certificate" enumId="PmtGiftCerificate" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Cash" enumId="PmtCash" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Financial Account" enumId="PmtFinancialAccount" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Personal Check" enumId="PmtPersonalCheck" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Company Check" enumId="PmtCompanyCheck" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Certified Check" enumId="PmtCertifiedCheck" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Money Order" enumId="PmtMoneyOrder" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Company Account" enumId="PmtCompanyAccount" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Billing Account" enumId="PmtBillingAccount" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Cash On Delivery" enumId="PmtCod" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Write-off" enumId="PmtWriteOff" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Discount" enumId="PmtDiscount" enumTypeId="PaymentMethodType"/>
            <!-- really need this? implied by various more specific others... <moqui.basic.Enumeration description="Offline Payment" enumId="PmtOffline" enumTypeId="PaymentMethodType"/> -->
        </seed-data>

        <master>
            <detail relationship="methodType"/>
            <detail relationship="ownerParty">
                <detail relationship="organization"/>
                <detail relationship="person"/>
            </detail>
            <detail relationship="postal" use-master="default"/>
            <detail relationship="telecom" use-master="default"/>
            <detail relationship="email" use-master="default"/>
            <detail relationship="trustLevel"/>
            <detail relationship="bankAccount"/>
            <detail relationship="bitcoinWallet"/>
            <detail relationship="creditCard"><detail relationship="type"/></detail>
            <detail relationship="giftCard"/>
            <detail relationship="payPalAccount"/>
        </master>
    </entity>
    <entity entity-name="PaymentMethodTrans" package-name="mantle.account.method">
        <description>Transactions of the PaymentMethod, such as imported from an OFX file (see www.ofx.net); can be
            imported from any source and reconciled in a more consistent way from here</description>
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="fitId" type="text-short" is-pk="true"><description>Financial Institution Transaction ID (OFX STMTTRN.FITID)</description></field>
        <field name="transType" type="text-short"><description>
            Transaction type (OFX STMTTRN.TRNTYPE)

            OFX STMTTRN.TRNTYPE (transType) possible values:
                CREDIT  Generic credit
                DEBIT   Generic debit
                INT*    Interest earned or paid NOTE: depends on signage of amount
                DIV*    Dividend
                FEE*    FI fee
                SRVCHG* Service charge
                DEP     Deposit
                ATM     ATM debit or credit NOTE: depends on signage of amount"
                POS     Point of sale debit or credit NOTE: depends on signage of amount
                XFER    Transfer
                CHECK   Check
                PAYMENT Electronic payment
                CASH    Cash withdrawal
                DIRECTDEP   Direct deposit
                DIRECTDEBIT Merchant initiated debit
                REPEATPMT   Repeating payment/standing order
                OTHER   Other

            No Enumeration set for this because we want to allow other values (NOTE: could also define Enumerations but have a one-nofk relationship)
        </description></field>
        <field name="postedDate" type="date-time"><description>Date posted (OFX STMTTRN.DTPOSTED)</description></field>
        <field name="transAmount" type="currency-amount"><description>Transaction amount (OFX STMTTRN.TRNAMT)</description></field>
        <field name="transName" type="text-short"><description>Transaction name (OFX STMTTRN.NAME or PAYEE; as per spec only one may be used)</description></field>
        <field name="transMemo" type="text-medium"><description>Transaction memo (OFX STMTTRN.MEMO)</description></field>
        <field name="checkNumber" type="text-short"><description>Check number, rarely included but very useful for reconciliation (OFX STMTTRN.CHECKNUM)</description></field>
        <field name="refNumber" type="text-short"><description>Reference number (OFX STMTTRN.REFNUM)</description></field>
        <!-- for reconciliation these refer to the records the PaymentMethodTrans matches -->
        <field name="paymentId" type="id"/>
        <field name="acctgTransId" type="id"/>
        <field name="acctgTransEntrySeqId" type="id"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" related-entity-name="mantle.ledger.transaction.AcctgTransEntry">
            <key-map field-name="acctgTransId"/><key-map field-name="acctgTransEntrySeqId"/></relationship>
    </entity>

    <entity entity-name="BankAccount" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="bankName" type="text-medium"/>
        <field name="bankPartyId" type="id"/>
        <field name="typeEnumId" type="id"/>
        <field name="routingNumber" type="text-short"/>
        <field name="accountNumber" type="text-medium"/>
        <!-- these are replaced by the PaymentMethod.*OnAccount fields
        <field name="nameOnAccount" type="text-medium"/>
        <field name="companyNameOnAccount" type="text-medium"/>
        -->
        <field name="lastCheckNumber" type="number-integer"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <relationship type="one" title="Bank" related-entity-name="mantle.party.Party">
            <key-map field-name="bankPartyId"/></relationship>
        <relationship type="one" title="BankAccountType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="typeEnumId"/></relationship>
        <seed-data>
            <moqui.basic.EnumerationType description="Bank Account Type" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Checking" enumId="BatChecking" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Savings" enumId="BatSavings" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Money Market" enumId="BatMoneyMarket" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Certificate of Deposit" enumId="BatCertDep" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Retirement" enumId="BatRetirement" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Credit Installment" enumId="BatCreditInstallment" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Credit Open" enumId="BatCreditOpen" enumTypeId="BankAccountType"/>
            <moqui.basic.Enumeration description="Credit Revolving" enumId="BatCreditRevolving" enumTypeId="BankAccountType"/>
        </seed-data>
    </entity>
    <entity entity-name="BankAccountCheck" package-name="mantle.account.method">
        <description>A simple check register (for Checking type BankAccount) with details on the Payment entity</description>
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="checkNumber" type="number-integer" is-pk="true"/>
        <field name="paymentId" type="id"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
    </entity>
    <entity entity-name="BitcoinWallet" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="walletAddress" type="text-medium"/>
        <field name="description" type="text-medium"/>
        <field name="onlineWalletUrl" type="text-medium"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>
    <entity entity-name="CreditCard" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="creditCardTypeEnumId" type="id"/>
        <field name="cardNumber" type="text-medium" encrypt="true"/>
        <field name="cardNumberLookupHash" type="text-medium"><description>A one-way hash (SHA, etc) of the cardNumber
            used for looking up a credit card by its number in a secure way.</description></field>
        <field name="validFromDate" type="text-short"><description>Not common in some parts of the world.</description></field>
        <field name="expireDate" type="text-short"><description>String representing the date in the format: MM/yyyy</description></field>
        <field name="issueNumber" type="text-short"><description>Single digit number on some Switch and Maestro cards.</description></field>
        <field name="cardSecurityCode" type="text-medium" encrypt="true"><description>CVV/etc number for card.
            By PCI rules can only be recorded until authorization is complete, after that must be deleted.
            Set the mantle.account.PaymentServices.authorize#SinglePayment service for where this is done.</description></field>

        <!-- these are replaced by the PaymentMethod.*OnAccount fields
        <field name="companyNameOnCard" type="text-medium"/>
        <field name="titleOnCard" type="text-medium"/>
        <field name="firstNameOnCard" type="text-medium"/>
        <field name="middleNameOnCard" type="text-medium"/>
        <field name="lastNameOnCard" type="text-medium"/>
        <field name="suffixOnCard" type="text-medium"/>
        -->

        <field name="consecutiveFailedAuths" type="number-integer"/>
        <field name="lastFailedAuthDate" type="date-time"/>
        <field name="consecutiveFailedNsf" type="number-integer"/>
        <field name="lastFailedNsfDate" type="date-time"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <relationship type="one" title="CreditCardType" related-entity-name="moqui.basic.Enumeration" short-alias="type">
            <key-map field-name="creditCardTypeEnumId"/></relationship>
        <index name="CC_NUMBER_LOOKUP"><index-field name="cardNumberLookupHash"/></index>
        <seed-data>
            <!-- Credit Card Type -->
            <moqui.basic.EnumerationType description="Credit Card Type" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Visa" enumId="CctVisa" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Master Card" enumId="CctMastercard" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="American Express" enumId="CctAmericanExpress" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Discover" enumId="CctDiscover" enumTypeId="CreditCardType"/>
            <!-- for reference, these are rare and some don't exist any more:
            <moqui.basic.Enumeration description="Diners Club" enumId="CctDinersClub" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="EnRoute" enumId="CctEnroue" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Carte Blanche" enumId="CctCarteBlanche" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="JCB" enumId="CctJcb" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Solo" enumId="CctSolo" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Switch" enumId="CctSwitch" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Visa Electron" enumId="CctVisaElectron" enumTypeId="CreditCardType"/>
            -->
        </seed-data>
    </entity>
    <entity entity-name="GiftCard" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="cardNumber" type="text-medium" encrypt="true"/>
        <field name="pinNumber" type="text-medium" encrypt="true"/>
        <field name="expireDate" type="text-short"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>
    <entity entity-name="GiftCardFulfillment" package-name="mantle.account.method">
        <field name="fulfillmentId" type="id" is-pk="true"/>
        <field name="typeEnumId" type="id"/>
        <field name="merchantId" type="id-long"/>
        <field name="partyId" type="id"/>
        <field name="orderId" type="id"/>
        <field name="orderItemSeqId" type="id"/>
        <field name="surveyResponseId" type="id"><!-- TODO replace this with dyn form or something --></field>
        <field name="cardNumber" type="text-medium" encrypt="true"/>
        <field name="pinNumber" type="text-medium" encrypt="true"/>
        <field name="amount" type="currency-amount"/>
        <field name="responseCode" type="text-short"/>
        <field name="referenceNum" type="text-short"/>
        <field name="authCode" type="text-short"/>
        <field name="fulfillmentDate" type="date-time"/>
        <relationship type="one" title="GiftCardFulfillmentType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="typeEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.party.Party"/>
        <relationship type="one" related-entity-name="mantle.order.OrderHeader"/>
        <relationship type="one" related-entity-name="mantle.order.OrderItem">
            <key-map field-name="orderId"/><key-map field-name="orderItemSeqId"/></relationship>
    </entity>
    <entity entity-name="PayPalAccount" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="payerId" type="id"/>
        <field name="expressCheckoutToken" type="text-short"/>
        <field name="payerStatus" type="text-short"/>
        <field name="avsAddr" type="text-indicator"/>
        <field name="avsZip" type="text-indicator"/>
        <field name="correlationId" type="text-short"/>
        <field name="transactionId" type="text-short"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>

    <entity entity-name="PaymentGatewayConfig" package-name="mantle.account.method">
        <field name="paymentGatewayConfigId" type="id" is-pk="true"/>
        <field name="paymentGatewayTypeEnumId" type="id"><description>Each payment gateway integration should define a
            PaymentGatewayType Enumeration record plus an entity with a shared PK (ie PK is paymentGatewayConfigId).</description></field>
        <field name="description" type="text-medium"/>
        <field name="authorizeServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.authorize#Payment interface.</description></field>
        <field name="captureServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.capture#Payment interface.</description></field>
        <field name="releaseServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.release#Payment interface.</description></field>
        <field name="refundServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.refund#Payment interface.</description></field>
        <relationship type="one" title="PaymentGatewayType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentGatewayTypeEnumId"/></relationship>
        <seed-data>
            <moqui.basic.EnumerationType description="Payment Gateway Type" enumTypeId="PaymentGatewayType"/>
            <moqui.basic.Enumeration description="Test" enumId="PgtTest" enumTypeId="PaymentGatewayType"/>
        </seed-data>
    </entity>
    <entity entity-name="PaymentGatewayResponse" package-name="mantle.account.method">
        <field name="paymentGatewayResponseId" type="id" is-pk="true"/>
        <field name="paymentGatewayConfigId" type="id"/>
        <field name="paymentOperationEnumId" type="id"/>
        <field name="paymentId" type="id"/>
        <field name="paymentMethodId" type="id"/>
        <field name="transCodeEnumId" type="id"/><!-- used? needed? -->
        <field name="amount" type="currency-amount"/>
        <field name="amountUomId" type="id"/>
        <field name="referenceNum" type="text-short"/>
        <field name="altReference" type="text-short"/>
        <field name="subReference" type="text-short"/>
        <field name="approvalCode" type="text-short"/>
        <field name="responseCode" type="text-short"/>
        <field name="reasonCode" type="text-short"/>
        <field name="reasonMessage" type="text-medium"/>
        <field name="avsResult" type="text-short"/>
        <field name="cvResult" type="text-short"/>
        <field name="scoreResult" type="text-short"/>
        <field name="transactionDate" type="date-time"/>
        <field name="resultSuccess" type="text-indicator"/>
        <field name="resultDeclined" type="text-indicator"/>
        <field name="resultError" type="text-indicator"/>
        <field name="resultNsf" type="text-indicator"/>
        <field name="resultBadExpire" type="text-indicator"/>
        <field name="resultBadCardNumber" type="text-indicator"/>
        <relationship type="one" title="PaymentOperation" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentOperationEnumId" related-field-name="enumId"/></relationship>
        <relationship type="one" title="TransCode" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="transCodeEnumId" related-field-name="enumId"/></relationship>
        <relationship type="one" title="Amount" related-entity-name="moqui.basic.Uom">
            <key-map field-name="amountUomId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <seed-data>
            <moqui.basic.EnumerationType description="Payment Gateway Operation" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Validate Authorize" enumId="PgoValidateAuthorize" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Authorize" enumId="PgoAuthorize" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Capture" enumId="PgoCapture" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Authorize and Capture" enumId="PgoAuthAndCapture" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Refund" enumId="PgoRefund" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Release" enumId="PgoRelease" enumTypeId="PaymentOperation"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.payment -->
    <!-- ========================================================= -->

    <entity entity-name="Deduction" package-name="mantle.account.payment">
        <field name="deductionId" type="id" is-pk="true"/>
        <field name="deductionTypeEnumId" type="id"/>
        <field name="paymentId" type="id"/>
        <field name="amount" type="currency-amount"/>
        <relationship type="one" title="DeductionType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="deductionTypeEnumId"/></relationship>
        <relationship type="one" related-entity-name="Payment"/>
    </entity>
    <entity entity-name="Payment" package-name="mantle.account.payment">
        <field name="paymentId" type="id" is-pk="true"/>
        <field name="paymentTypeEnumId" type="id"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>

        <field name="paymentMethodTypeEnumId" type="id"/>
        <field name="paymentMethodId" type="id"><description>The from PaymentMethod (owned by fromPartyId)</description></field>
        <field name="toPaymentMethodId" type="id"><description>The to PaymentMethod (owned by toPartyId), if applicable,
            the account the payment goes to</description></field>
        <field name="paymentGatewayConfigId" type="id"><description>Use this PaymentGatewayConfig for auth/etc. For Payments
            by CC/etc that are not from an order and/or the order is not associated with a ProductStore. Also set
            automatically on auth for capture, etc.</description></field>
        <field name="orderId" type="id"><description>Set if the Payment represents the payment settings for an Order.</description></field>
        <field name="orderPartSeqId" type="id"><description>Set if the Payment represents the payment settings for an OrderPart.</description></field>

        <field name="statusId" type="id" enable-audit-log="true"/>
        <field name="effectiveDate" type="date-time"/>
        <field name="paymentAuthCode" type="text-short"/>
        <field name="paymentRefNum" type="text-short"/>
        <field name="comments" type="text-medium"/>
        <field name="memo" type="text-medium"/>

        <field name="amount" type="currency-amount"/>
        <field name="amountUomId" type="id"/>

        <field name="finAccountId" type="id"/>
        <field name="finAccountAuthId" type="id"/>
        <field name="finAccountTransId" type="id"/>
        <field name="overrideGlAccountId" type="id"><description>Overrides the GlAccount for the PaymentMethod entry,
            ie for the cash account the payment goes into.</description></field>
        <field name="overrideOrgPartyId" type="id"><description>Used to specify the organization override rather than
            using the fromPartyId and/or toPartyId (depending on which is an internal org).</description></field>

        <field name="partyRelationshipId" type="id"><description>For Payroll payments, points to Employment record</description></field>
        <field name="timePeriodId" type="id"><description>For Payroll payments, points to Payroll TimePeriod</description></field>

        <!-- The Original Currency amount and uomId are for the values coming from the bank (if known) and are to be used for reconciliation and such later, and not for PaymentApplication. -->
        <field name="originalCurrencyAmount" type="currency-amount"/>
        <field name="originalCurrencyUomId" type="id"/>

        <field name="presentFlag" type="text-indicator"/>
        <field name="swipedFlag" type="text-indicator"/>
        <field name="processAttempt" type="number-integer"/>
        <field name="needsNsfRetry" type="text-indicator"/>

        <field name="visitId" type="id"><description>Track the Visit so we know the session info, including client IP,
            for audit and fraud purposes.</description></field>
        <field name="acctgTransResultEnumId" type="id"/>
        <field name="reconcileStatusId" type="id" default="'PmtrNot'"/>

        <relationship type="one" title="PaymentType" related-entity-name="moqui.basic.Enumeration" short-alias="type">
            <key-map field-name="paymentTypeEnumId"/></relationship>
        <relationship type="one" title="PaymentMethodType" related-entity-name="moqui.basic.Enumeration" short-alias="methodType">
            <key-map field-name="paymentMethodTypeEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod" short-alias="method"/>
        <relationship type="one" title="To" related-entity-name="mantle.account.method.PaymentMethod" short-alias="toMethod">
            <key-map field-name="toPaymentMethodId"/></relationship>
        <relationship type="one-nofk" related-entity-name="mantle.account.method.CreditCard"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentGatewayConfig"/>
        <relationship type="one" related-entity-name="mantle.order.OrderHeader"/>

        <relationship type="one" title="Amount" related-entity-name="moqui.basic.Uom" short-alias="amountUom">
            <key-map field-name="amountUomId"/></relationship>
        <relationship type="one" title="From" related-entity-name="mantle.party.Party" short-alias="fromParty">
            <key-map field-name="fromPartyId"/></relationship>
        <relationship type="one" title="To" related-entity-name="mantle.party.Party" short-alias="toParty">
            <key-map field-name="toPartyId"/></relationship>
        <relationship type="one" title="Payment" related-entity-name="moqui.basic.StatusItem" short-alias="status"/>

        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccount"/>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccountAuth"/>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccountTrans"/>
        <relationship type="one" title="Override" related-entity-name="mantle.ledger.account.GlAccount">
            <key-map field-name="overrideGlAccountId"/></relationship>
        <relationship type="one" title="OverrideOrg" related-entity-name="mantle.party.Party">
            <key-map field-name="overrideOrgPartyId"/></relationship>

        <relationship type="one" related-entity-name="mantle.humanres.employment.Employment"/>
        <relationship type="one" related-entity-name="mantle.party.time.TimePeriod"/>

        <relationship type="one" title="OriginalCurrency" related-entity-name="moqui.basic.Uom">
            <key-map field-name="originalCurrencyUomId"/></relationship>
        <relationship type="one" related-entity-name="moqui.server.Visit"/>
        <relationship type="one" title="AcctgTransResult" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="acctgTransResultEnumId"/></relationship>
        <relationship type="one" title="AcctgTransEntryReconcile" related-entity-name="moqui.basic.StatusItem">
            <key-map field-name="reconcileStatusId"/></relationship>

        <relationship type="many" related-entity-name="mantle.account.payment.PaymentApplication" short-alias="applications">
            <key-map field-name="paymentId"/></relationship>
        <relationship type="many" related-entity-name="mantle.account.payment.PaymentContent" short-alias="contents">
            <key-map field-name="paymentId"/></relationship>

        <seed-data>
            <!-- Payment Type -->
            <moqui.basic.EnumerationType description="Payment Type" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Disbursement" enumId="PtDisbursement" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Refund" enumId="PtRefund" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Invoice Payment" enumId="PtInvoicePayment" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Financial Account Transaction" enumId="PtFinancialAccount" enumTypeId="PaymentType"/>

            <!-- Payment Status -->
            <moqui.basic.StatusType description="Payment Status" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Proposed" sequenceNum="1" statusId="PmntProposed" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Promised" sequenceNum="2" statusId="PmntPromised" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Authorized" sequenceNum="3" statusId="PmntAuthorized" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Delivered" sequenceNum="4" statusId="PmntDelivered" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Confirmed Paid" sequenceNum="6" statusId="PmntConfirmed" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Cancelled" sequenceNum="91" statusId="PmntCancelled" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Void" sequenceNum="92" statusId="PmntVoid" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Declined" sequenceNum="93" statusId="PmntDeclined" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Refunded" sequenceNum="94" statusId="PmntRefunded" statusTypeId="Payment"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntProposed" toStatusId="PmntPromised" transitionName="Promise"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntProposed" toStatusId="PmntCancelled" transitionName="Promise"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntPromised" toStatusId="PmntAuthorized" transitionName="Authorize"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntPromised" toStatusId="PmntDelivered" transitionName="Deliver"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntPromised" toStatusId="PmntCancelled" transitionName="Cancel"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntPromised" toStatusId="PmntDeclined" transitionName="Sent"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntDeclined" toStatusId="PmntAuthorized" transitionName="Authorize"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntAuthorized" toStatusId="PmntDelivered" transitionName="Deliver"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntAuthorized" toStatusId="PmntVoid" transitionName="Void"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntAuthorized" toStatusId="PmntDeclined" transitionName="Decline"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntDelivered" toStatusId="PmntRefunded" transitionName="Refund"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntConfirmed" toStatusId="PmntRefunded" transitionName="Refund"/>

            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntDelivered" toStatusId="PmntConfirmed" transitionName="Confirm"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntDelivered" toStatusId="PmntVoid" transitionName="Void"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntDelivered" toStatusId="PmntPromised" transitionName="Undeliver"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmntConfirmed" toStatusId="PmntDelivered" transitionName="Uncomfirm"/>

            <!-- Payment Reconcile Status -->
            <moqui.basic.StatusType description="Payment Reconcile Status" statusTypeId="PaymentReconcile"/>
            <moqui.basic.StatusItem description="Not Reconciled" sequenceNum="1" statusId="PmtrNot" statusTypeId="PaymentReconcile"/>
            <moqui.basic.StatusItem description="Partly Reconciled" sequenceNum="2" statusId="PmtrPartly" statusTypeId="PaymentReconcile"/>
            <moqui.basic.StatusItem description="Reconciled" sequenceNum="3" statusId="PmtrRec" statusTypeId="PaymentReconcile"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmtrNot" toStatusId="PmtrPartly" transitionName="Partly Reconcile"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmtrNot" toStatusId="PmtrRec" transitionName="Reconcile"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmtrPartly" toStatusId="PmtrRec" transitionName="Reconcile"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmtrPartly" toStatusId="PmtrNot" transitionName="Unreconcile"/>
            <moqui.basic.StatusFlowTransition statusFlowId="Default" statusId="PmtrRec" toStatusId="PmtrNot" transitionName="Unreconcile"/>
        </seed-data>

        <master>
            <detail relationship="type"/>
            <detail relationship="methodType"/>
            <detail relationship="method" use-master="default"/>
            <detail relationship="amountUom"/>
            <detail relationship="fromParty" use-master="basic"/>
            <detail relationship="toParty" use-master="basic"/>
            <detail relationship="status"/>
            <detail relationship="applications"/>
            <detail relationship="contents"/>
        </master>
    </entity>
    <entity entity-name="PaymentFraudEvidence" package-name="mantle.account.payment">
        <description>
            Evidence of payment fraud with references to the Payment and possibly OrderHeader that represents the fraud.

            Other entities like ContactMech and PaymentMethod have a reference to this entity when they are gray- or
            black-listed based on this evidence.
        </description>
        <field name="paymentFraudEvidenceId" type="id" is-pk="true"/>
        <field name="fraudTypeEnumId" type="id"/>
        <field name="comments" type="text-medium"/>
        <field name="paymentId" type="id"/>
        <field name="orderId" type="id"/>
        <field name="partyId" type="id"/>
        <field name="visitId" type="id"/>
        <relationship type="one" title="FraudType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="fraudTypeEnumId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" related-entity-name="mantle.order.OrderHeader"/>
        <relationship type="one" related-entity-name="mantle.party.Party"/>
        <relationship type="one" related-entity-name="moqui.server.Visit"/>
    </entity>
    <entity entity-name="PaymentApplication" package-name="mantle.account.payment">
        <field name="paymentApplicationId" type="id" is-pk="true"/>
        <field name="paymentId" type="id"/>
        <field name="invoiceId" type="id"/>
        <field name="invoiceItemSeqId" type="id"/>
        <field name="billingAccountId" type="id"/>
        <field name="overrideGlAccountId" type="id"><description>If filled in, payment is applied directly against this
            GL account</description></field>
        <field name="toPaymentId" type="id"><description>To be used when a payment is based on or comes from another
            payment, like a payment that is a return of a mistaken or over-payment</description></field>
        <field name="taxAuthGeoId" type="id"/>
        <field name="amountApplied" type="currency-amount"/>
        <field name="amountOriginallyApplied" type="currency-amount"/>
        <field name="appliedDate" type="date-time"/>
        <field name="acctgTransResultEnumId" type="id"/>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment">
            <key-map field-name="paymentId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice">
            <key-map field-name="invoiceId"/></relationship>
        <relationship type="one-nofk" related-entity-name="mantle.account.invoice.InvoiceItem">
            <key-map field-name="invoiceId"/><key-map field-name="invoiceItemSeqId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.billing.BillingAccount">
            <key-map field-name="billingAccountId"/></relationship>
        <relationship type="one" title="To" related-entity-name="mantle.account.payment.Payment">
            <key-map field-name="toPaymentId"/></relationship>
        <relationship type="one" title="TaxAuth" related-entity-name="moqui.basic.Geo">
            <key-map field-name="taxAuthGeoId"/></relationship>
        <relationship type="one" title="Override" related-entity-name="mantle.ledger.account.GlAccount">
            <key-map field-name="overrideGlAccountId"/></relationship>
        <relationship type="one" title="AcctgTransResult" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="acctgTransResultEnumId"/></relationship>
    </entity>
    <entity entity-name="PaymentBudgetAllocation" package-name="mantle.account.payment">
        <field name="paymentId" type="id" is-pk="true"/>
        <field name="budgetId" type="id" is-pk="true"/>
        <field name="budgetItemSeqId" type="id" is-pk="true"/>
        <field name="amount" type="currency-amount"/>
        <relationship type="one" related-entity-name="mantle.other.budget.BudgetItem">
            <key-map field-name="budgetId"/><key-map field-name="budgetItemSeqId"/></relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
    </entity>
    <entity entity-name="PaymentContent" package-name="mantle.account.payment">
        <field name="paymentContentId" type="id" is-pk="true"/>
        <field name="paymentId" type="id"/>
        <field name="contentLocation" type="text-medium"/>
        <field name="contentTypeEnumId" type="id"/>
        <field name="description" type="text-long"/>
        <field name="contentDate" type="date-time" default="ec.user.nowTimestamp"/>
        <field name="userId" type="id-long" default="ec.user.userId"/>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" title="PaymentContentType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="contentTypeEnumId"/></relationship>
        <seed-data>
            <!-- Payment Content Type -->
            <moqui.basic.EnumerationType description="Payment Content Type" enumTypeId="PaymentContentType"/>
            <moqui.basic.Enumeration enumId="IctPaymentDocument" description="Payment Document" enumTypeId="PaymentContentType"/>
            <moqui.basic.Enumeration enumId="IctReceipt" description="Receipt" enumTypeId="PaymentContentType"/>
            <moqui.basic.Enumeration enumId="IctCheckImage" description="Check Image" enumTypeId="PaymentContentType"/>
        </seed-data>
    </entity>
</entities>
